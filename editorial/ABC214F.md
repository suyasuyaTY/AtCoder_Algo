# ABC214-F

`S`: 1-indexedにする。

## 1. 条件を緩和した問題

> $S$ の空文字列でない部分文字列の個数を求めよ。ただし、部分文字列とは元の文字列から $
0$ 文字以上取り除き残った文字を元の順番で並べたものである。

$dp[i]$: 文字列 $S$ の $1$ 文字目から $i$ 文字目までの部分から得られる部分文字列のうち $i$ 文字目は必ず使うようなものの個数。ただし、$dp[0] \sim dp[i-1]$ で数えられていないもの個数。

- $dp[0] = 1$: `""`に対応
- $dp[i] = \sum_{j = k}^{i-1} dp[j]$ : $k$ は $S[k] = S[i] \land k < i$ を満たす最大の数。もし存在しなければ $k = 0$。

$S[j](j < k)$ から $S[i]$ につなげるものは、すでに $dp[l] (l \le k \land S[l] == S[i])$ で数えられているので足さない。


## 2. 本問題

同じような`dp`を立てつつ、連続する文字を選ばないような工夫を考える。

$k$ を先ほどと同じように $S[k] = S[i] \land k < i$ を満たす最大の数(もし存在しなければ $k = 0$) と定義する。

ここで、$S[j](j < k - 1)$ から $S[i]$ につなげるものは、すでに $dp[l] (l \le k \land S[l] == S[i])$ で数えられているということに注意して`dp`を立てる。

$dp[i+1]$: 文字列 $S$ の $1$ 文字目から $i$ 文字目までの部分から得られる部分文字列のうち $i$ 文字目は必ず使うようなものの個数。ただし、$dp[0] \sim dp[i]$ で数えられていないもの個数。


- $dp[0] = 1, dp[1] = 0$: `""`に対応。$dp[2]$ を場合分けしなくて済むための工夫。
- $dp[i+1] = \sum_{j = k}^{i-1} dp[j]$ : $k$ は $S[k] = S[i] \land k < i$ を満たす最大の数。もし存在しなければ $k = 0$。

 