# 包除原理

## 普通の包除原理

### 定義

有限集合$S_1, S_2, \cdots, S_N$があるとする。$[N] = \{1,2,\cdots, N \}$としたとき、

$$
\left|\bigcup_{i=1}^N S_i \right| = \sum_{i=1}^{N} (-1)^{i-1} \sum_{J \subset |N|, |J| = i} \left|\bigcap_{j \in J} S_j \right|
$$

が成り立つ。

### 証明

二項定理より$n > 0$に対し、次の式が成り立つ

$$
\sum_{i=1}^n \binom{n}{i} (-1)^{i - 1} = 1
$$

$\bigcup_{i=1}^N S_i$の要素$x$を任意にとる。$x$は$S_i$に$k$個属するとする。このとき、$S_1, S_2, \cdots, S_N$から$i$個の集合を選び共通部分$T$を考えたとき、$x$が$T$に属するものの個数は$\binom{k}{i}$個となる。ここで、定義の式を見ると要素数$i$の集合には$(-1)^{i-1}$がかけられることになり。$x$の包除原理の式に対する寄与は$\sum_{i=1}^n \binom{n}{i} (-1)^{i - 1}$となるので、これは1になる。よって、定義の式は各要素が1つのみ数えられることになるので正しい。

## 一般の包除原理


## 参考文献
[しょぼんさん-通常](https://shobon2019.hatenablog.com/entry/2023/07/13/015052)
[しょぼんさん-一般](https://shobon2019.hatenablog.com/entry/2023/07/13/015052)