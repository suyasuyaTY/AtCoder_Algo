# Z_algorithm

## できること

文字列が与えられたとき、各`i` について「`S` と`S[i:]` の最長共通接頭辞の長さ」を記録した配列`A` を$O(|S|)$で構築する

## アルゴリズムの解説

### コード

```cpp
// 中身
A[0] = S.size();
int i = 1, j = 0;
while (i < S.size()) {
  while (i+j < S.size() && S[j] == S[i+j]) ++j;
  A[i] = j;
  if (j == 0) { ++i; continue;}
  int k = 1;
  while (i+k < S.size() && k+A[k] < j) A[i+k] = A[k], ++k;
  i += k; j -= k;
}

// ACL
vector<int> A = z_alrorithm(S);
```

### 解説

1. `i=0`の時は明らかなので`i=1`から見ていく
2. `S`と`S[i:]`が一致する最大の長さ`j`を求める
3. 始点`i` 、長さ`j` の中に含まれる点`i+k` について考える
    - `S[0,j-1]`と`S[i,i+j-1]`が一致するため、`S[0,A[k]-1]=S[k,k+A[k]-1]=S[i+k,i+k+A[k]-1]` が成り立つ可能性がある
    - 成り立つ条件は始点`i` 、長さ`j` に内側（境界上はダメ）に含まれていることなので、`k+A[k] < j`  となる
4. 次のステップ
    - 2の計算で`k` 個分だけ計算をスキップできたので次の始点は`i+k`から始めることができる。
    - 前のステップが終わる条件から、始点`i+k` から始めるときに`k-j` までは一致していることがわかるのでそこから始める

## 参考文献
[snukeさん](https://snuke.hatenablog.com/entry/2014/12/03/214243)